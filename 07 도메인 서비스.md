도메인 서비스
===============
# 여러 애그리거트가 필요한 기능   
   
보통 한 애그리거트로 기능을 구현할 수 없을 때가 있다.      

* **상품 애그리거트 :**  
    * 구매하는 상품의 가격이 필요하다.     
    * 상품에 따라 배송비가 추가되기도 한다.     
* **주문 애그리거트 :**  
    * 상품별로 구매 개수가 필요하다.    
* **할인 쿠폰 애그리거트 :**  
    * 쿠폰별로 지정한 할인 금액이나 비율에 따라 주문 총 금액을 할인한다.    
    * 할인 쿠폰을 조건에 따라 중복 사용할 수 있다거나    
      지정한 카테고리의 상품에만 적용할 수 있다는 제약조건이 있다면 할인 계산이 복잡해진다.   
* **회원 애그리거트 :**           
    * 회원 등급에 따라 추가 할인이 가능하다.   
  
가격과 할인등의 작업이 여러 애그리거트에서 이루어지는데      
**실제 금액을 계산해야하는 주제는 어떤 애그리거트일까?**    
  
총 주문 금액 계산은 `주문` 애그리거트가 할 수 있지만, 실제 결제 금액은 이야기가 다르다.           
우선은, 주문 애그리거트가 실제 금액 계산을 위해 필요한 애그리거트나 필요한 데이터를 모두 가진다고 가정하자.      

```java
```
    
여기서 고민거리는 **실제 결제 금액 계산 로직이 주문 애그리거트의 책임이 맞는냐에 대한 것이다.**        
사실, 할인 정책은 **주문 애그리거트가 갖고 있는 요소와는 관련이 없다.**          
그럼에도 불구하고 위 코드는 결제 금액 계산 책임이 주문 애그리거트에 있다고 가정하므로        
**정책 변경시 주문 애그리거트의 코드를 수정해야하는 문제를 야기한다.**        
      
이렇게 **애그리거트에 넣기에 애매한 도메인 기능을 특정 애그리거트에서 억지로 구현하면 안 된다.**              
이 경우 **애그리거트는 자신의 책임 범위를 넘어서는 기능을 구현하기 때문에 코드가 길어지고 외부에 대한 의존이 높아진다.**               
이는 코드를 복잡하게 만들어 수정을 어렵게 만드는 요인이 된다.         
게다가 애그리거트의 범위를 넘어서는 도메인 개념이 애그리거트에 숨어들어서 명시적으로 드러나지 않게 된다.      
   
이런 문제를 해소하는 가장 쉬운 방법이 하나 있는데        
그것은 바로 **도메인 서비스를 별도로 구현하는 것이다.**       

# 도메인 서비스 
한 애그리거트에 넣기 애매한 도메인 개념을 구현하려면        
**애그리거트에 억지로 넣기보다는 도메인 서비스를 이용해서 도메인 개념을 명시적으로 드러내면 된다.**      
      
  






