# 4ê°œì˜ ì˜ì—­ 

1. í‘œí˜„/UI  
2. ì‘ìš©
3. ë„ë©”ì¸
4. ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ 

## í‘œí˜„/UI    
ì‚¬ìš©ìì˜ **ìš”ì²­ì„ í•´ì„í•´ì„œ ì‘ìš© ì„œë¹„ìŠ¤ì— ì „ë‹¬**í•˜ê³         
ì‘ìš© ì„œë¹„ìŠ¤ì˜ **ê²°ê³¼ë¥¼ ì‚¬ìš©ìê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì„œ ì‘ë‹µ**í•œë‹¤.          
   
**ì—¬ê¸°ì„œ ì‚¬ìš©ìë€? ğŸ¤”**   
```
ì›¹ ë¸Œë¼ìš°ì €ì´ê±°ë‚˜, REST APIë¥¼ ì´ìš©í•œ ì™¸ë¶€ ì‹œìŠ¤í…œì¼ ìˆ˜ ìˆë‹¤.(ëª¨ë°”ì¼, ê¸°íƒ€ ë“±ë“±)   
```
           
ì¦‰, `HTTP ìš”ì²­`ì„ **ì‘ìš© ì˜ì—­ì´ í•„ìš”ë¡œ í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì„œ `ì‘ìš© ì˜ì—­`ì— ì „ë‹¬**í•˜ê³              
**`ì‘ìš© ì˜ì—­ì˜ ì‘ë‹µ`ì„ HTTP ì‘ë‹µìœ¼ë¡œ ë³€í™˜í•´ì„œ ì „ì†¡í•œë‹¤.**(Modelì€ í•´ë‹¹ ì‚¬í•­ì´ ì•„ë‹ˆë‹¤.)             
         
ì‰½ê²Œ ë§í•˜ë©´,       
`@RequestBody`ë¥¼ ì´ìš©í•´ì„œ `ì‚¬ìš©ì`ë¡œë¶€í„° ë„˜ì–´ì˜¨ ê°’ì„ `HTTP ìš”ì²­ ë³¸ë¬¸ì— ë‹´ê¸´ ê°’ë“¤ì„ ìë°” ê°ì²´ë¡œ ë³€í™˜`í•œ í›„ `Service`ì— ë„˜ê¸°ê³            
`@ResponseBody`ë¥¼ ì´ìš©í•´ì„œ `Servic`ë¡œë¶€í„° ë„˜ì–´ì˜¨ ê°’ì„ `HTTP ì‘ë‹µ ë³¸ë¬¸ì˜ JSON ê°ì²´ë¡œ ë³€í™˜`í•œ í›„ ì‘ë‹µí•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.          
ì¦‰, `Controller`ê°€ ëŒ€í‘œì ì¸ ì˜ˆì‹œë¼ê³  ë³´ë©´ ëœë‹¤. (MVCë¼ê³  ì±…ì—ì„œëŠ” ë‚˜ì™”ëŠ”ë° ë” ìì„¸íˆ ë§í•˜ë©´)        
         
## ì‘ìš©   
ì‚¬ìš©ìì—ê²Œ **ì œê³µí•´ì•¼ í•  ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤.**       
`ì£¼ë¬¸ ë“±ë¡`, `ì£¼ë¬¸ ì·¨ì†Œ`, `ìƒí’ˆ ìƒì„¸ ì¡°íšŒ` ë“±ë“±...      
        
`ì‘ìš© ì˜ì—­`ì€ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ **ë„ë©”ì¸ ì˜ì—­ì˜ ë„ë©”ì¸ ëª¨ë¸ë“¤ì„ ì´ìš©í•œë‹¤.**     

```java
public class CancelOrderService {
      
    @Transactional    
    public void cancelOrder(String orderId) {    
        Order order = findOrderById(orderId);     
        if(order == null) throw new OrderNotFoundException(orderId);      
        order.cancel();   
    }
}  
```  
ì‘ìš© ì„œë¹„ìŠ¤ëŠ” ë¡œì§ì„ ì§ì ‘ ìˆ˜í–‰í•˜ê¸° ë³´ë‹¤ëŠ”         
**ë„ë©”ì¸ ëª¨ë¸ì— ë¡œì§ ìˆ˜í–‰ì„ ìœ„ì„í•œë‹¤.(ì—­í• ê³¼ ì±…ì„)**              
ìœ„ ì½”ë“œë„ ë„ë©”ì¸ì¸ `Order`ê°€ `ì·¨ì†Œ ì²˜ë¦¬`ë¥¼ í•˜ê³  ìˆë‹¤.    
        
ê°œì¸ì ìœ¼ë¡œ, `ì—­í• `/`ì±…ì„`/`í˜‘ë ¥`ì—ì„œ `í˜‘ë ¥ì„ í•˜ëŠ” ê³µê°„`ì´ë¼ê³ ë„ ìƒê°€í•©ë‹ˆë‹¤.     
   
## ë„ë©”ì¸  
ë„ë©”ì¸ ì˜ì—­ì€ **`ë„ë©”ì¸ ëª¨ë¸`ì„ êµ¬í˜„í•˜ëŠ” ì˜ì—­**ì´ë‹¤.(`Order`, `ShippingInfo` ë“±ë“±...)        
ê·¸ë¦¬ê³  **`ë„ë©”ì¸ ëª¨ë¸`ì€ ë„ë©”ì¸ì˜ í•µì‹¬ ë¡œì§ì„ êµ¬í˜„**í•œë‹¤.     
     
**ì£¼ë¬¸ ë„ë©”ì¸**     
* ë°°ì†¡ì§€ ë³€ê²½    
* ê²°ì œ ì™„ë£Œ        
* ì£¼ë¬¸ ì´ì•¡ ê³„ì‚°    

## ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜
ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­ì€ **êµ¬í˜„ ê¸°ìˆ **ì— ëŒ€í•œ ê²ƒì„ ë‹¤ë£¬ë‹¤.     

* `RDBMS` ì—°ë™ì²˜ë¦¬
* [ë©”ì‹œì§• í](https://ko.wikipedia.org/wiki/%EB%A9%94%EC%8B%9C%EC%A7%80_%ED%81%90)ì— ë©”ì‹œì§€ ì „ì†¡í•˜ê±°ë‚˜ ìˆ˜ì‹     
* `ëª½ê³  DB`, `HBase` ë¥¼ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë² ì´ìŠ¤ ì—°ë™ ì²˜ë¦¬  
* `SMTP`ë¥¼ ì´ìš©í•œ ë©”ì¼ ë°œì†¡ ê¸°ëŠ¥ êµ¬í˜„      
* `HTTP í´ë¼ì´ì–¸íŠ¸`ë¥¼ ì´ìš©í•´ì„œ `REST API`ë¥¼ í˜¸ì¶œ     
  
`ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­`ì€      
**ë…¼ë¦¬ì ì¸ ê°œë…ì„ í‘œí˜„í•˜ê¸° ë³´ë‹¤ëŠ” `ì‹¤ì œ êµ¬í˜„`ì„ ë‹¤ë£¬ë‹¤.**         
    
`ë„ë©”ì¸ ë¡œì§`, `ì‘ìš© ì˜ì—­`, `í‘œí˜„ ì˜ì—­`ì€ êµ¬í˜„ ê¸°ìˆ ì„ ì‚¬ìš©í•œ ì½”ë“œë¥¼ ì§ì ‘ ë§Œë“¤ì§€ëŠ” ì•ŠëŠ”ë‹¤.   
ëŒ€ì‹ , **ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­ì—ì„œ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ í•„ìš”í•œ ê¸°ëŠ¥ì„ ê°œë°œí•œë‹¤.**    
     
ì˜ˆì‹œ1)        
1. ì‘ìš© ì˜ì—­ì´ DBì— ë³´ê´€ëœ ë°ì´í„°ê°€ í•„ìš”
2. ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­ì˜ DB ëª¨ë“ˆì„ ì‚¬ìš©í•´ì„œ ë°ì´í„°ë¥¼ ì½ì–´ì˜¨ë‹¤.   
       
ì˜ˆì‹œ2)       
1. SMTP ì—°ë™ ëª¨ë“ˆì„ ì´ìš©í•´ì„œ ë©”ì¼ ë°œì†¡    
      
ì‚¬ì‹¤ ì—¬ê¸°ì„œ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•˜ëŠ” ì ì€ **ê´€ì‹¬ì‚¬ ë¶„ë¦¬**ì´ë‹¤.      
`ë„ë©”ì¸ ë¡œì§`, `ì‘ìš© ì˜ì—­`, `í‘œí˜„ ì˜ì—­`ì€ **êµ¬í˜„ ê¸°ìˆ ì„ ì–´ë–»ê²Œ ì‚¬ìš©í–ˆëŠ”ì§€ ê´€ì‹¬ì´ ì—†ë‹¤.**         
ì˜¤ë¡œì§€ `ë°ì´í„°`ë§Œì„ í•„ìš”ë¡œ í•˜ê³  **ê·¸ ë°ì´í„°ë¥¼ ì˜ ê°€ê³µí•˜ëŠ” ì—­í• ë§Œì„ í•œë‹¤.**      
ì¦‰, ìì‹ ì˜ ì—­í• ê³¼ ì±…ì„ -> `ì½”ì–´ ë°¸ë¥˜`ë§Œì„ ìƒê°í•  ë¿ì´ë‹¤.      
      
# ê³„ì¸µ êµ¬ì¡° ì•„í‚¤í…ì²˜     
`4 ì˜ì—­`ì„ êµ¬ì„±í•  ë•Œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì•„í‚¤í…ì²˜ê°€ ì•„ë˜ì™€ ê°™ì€ êµ¬ì¡°ì´ë‹¤.   
    
[ì‚¬ì§„](#)    
       
`í‘œí˜„ ì˜ì—­`ê³¼ `ì‘ìš© ì˜ì—­`ì€ `ë„ë©”ì¸ ì˜ì—­`ì„ ì‚¬ìš©í•˜ê³ ,       
`ë„ë©”ì¸ ì˜ì—­`ì€ `ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­`ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ê³„ì¸µ êµ¬ì¡°ê°€ ì ë‹¹í•´ ë³´ì¸ë‹¤.          
ë¬¼ë¡ , ë„ë©”ì¸ ë³µì¡ë„ì— ë”°ë¼, ì‘ìš©ê³¼ ë„ë©”ì¸ì„ ë¶„ë¦¬í•˜ê¸°ë„ í•˜ê³  í•œ ê³„ì¸µìœ¼ë¡œ í•©ì¹˜ê¸°ë„ í•œë‹¤.         
    
**ê³„ì¸µ êµ¬ì¡°ëŠ” íŠ¹ì„±ìƒ**      
* **`ìƒìœ„ ê³„ì¸µ`ì—ì„œ `í•˜ìœ„ ê³„ì¸µ`ìœ¼ë¡œì˜ ì˜ì¡´ë§Œ ì¡´ì¬í•œë‹¤.**  
* **`í•˜ìœ„ ê³„ì¸µ`ì€ `ìƒìœ„ ê³„ì¸µ`ì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ”ë‹¤.**     
   
```java
@Controller
public class SampleController {
    private final SampleService sampleService; // í•˜ìœ„ë¥¼ ì˜ì¡´
    
    public SampleController(SampleService sampleService) {
        this.sampleService = sampleService;
    }
    ... // 
}
```
ìš°ë¦¬ê°€ í”íˆ ì‚¬ìš©í•˜ëŠ” ì½”ë“œë¥¼ ë‹¤ì‹œë³´ë©´    
`ìƒìœ„ ê³„ì¸µì¸ í‘œí˜„ ì˜ì—­`ì—ì„œ `í•˜ìœ„ ê³„ì¸µì¸ ì‘ìš© ì˜ì—­`ì„ ì˜ì¡´í•˜ê³  ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.      
   
[ì‚¬ì§„](#)  
         
ê³„ì¸µ êµ¬ì¡°ë¥¼ ì—„ê²©í•˜ê²Œ ì ìš©í•˜ë©´ `ìƒìœ„ ê³„ì¸µ`ì€ ë°”ë¡œ ì•„ë˜ì˜ `í•˜ìœ„ ê³„ì¸µ`ì—ë§Œ ì˜ì¡´í•´ì•¼í•œë‹¤.           
í•˜ì§€ë§Œ, ìœ„ì™€ ê°™ì´ êµ¬í˜„ì˜ í¸ë¦¬ìƒ **ê³„ì¸µ êµ¬ì¡°ë¥¼ ìœ ì—°í•˜ê²Œ ì ìš©í•  ìˆ˜ë„ ìˆë‹¤.**     
     
ì¦‰, `ì‘ìš© ê³„ì¸µ`ì€ ë°”ë¡œ ì•„ë˜ ê³„ì¸µì¸ `ë„ë©”ì¸ ê³„ì¸µ`ì— ì˜ì¡´í•˜ì§€ë§Œ       
**ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ì˜ ì—°ë™ì„ ìœ„í•´** ë” ì•„ë˜ ê³„ì¸µì¸ `ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ ê³„ì¸µ`ì— ì˜ì¡´í•˜ê¸°ë„ í•œë‹¤.          
  
```java
@Service
public class SampleServiceImpl implements SampleService {
  
    private final SampleRepository sampleRepository; // ë„ë©”ì¸ì´ ì•„ë‹Œ ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­  
                                                     // ìƒìœ„ ê³„ì¸µì— ëŒ€í•œ ì˜ì¡´ì´ ì—†ë‹¤.  
                                                     
    public SampleServiceImpl(SampleRepository sampleRepository) {
        this.sampleRepository = sampleRepository;
    }
     
    public void findById(Long id) {  
        // ì—¬ê¸°ì„œ ë„ë©”ì¸ì„ ì–»ì–´ì„œ ì‚¬ìš©í•œë‹¤.   
        Sample sample = sampleRepository.findById(id).orElseThrow(() ->
                new NoSearchSampleByIdException(id));
    }
    
}
```
       
`ì‘ìš© ì˜ì—­`ê³¼ `ë„ë©”ì¸ ì˜ì—­`ì€        
`DB`ë‚˜ `ì™¸ë¶€ ì‹œìŠ¤í…œ ì—°ë™`ì„ ìœ„í•´ `ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ì˜ ê¸°ëŠ¥`ì„ ì‚¬ìš©í•˜ë¯€ë¡œ        
ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ **ì§ê´€ì ìœ¼ë¡œ ì´í•´í•˜ê¸° ì‰¬ìš°ë©° êµ¬í˜„ ë˜í•œ í¸ë¦¬í•˜ë‹¤.**       
         
í•˜ì§€ë§Œ, ì—¬ê¸°ì„œ ì§šê³  ë„˜ì–´ê°ˆ ë¶€ë¶„ì€             
ìì¹« í•˜ë©´, `ì‘ìš© ê³„ì¸µ`ê³¼ `ë„ë©”ì¸ ê³„ì¸µ`ì´       
**êµ¬í˜„ ë°©ë²•ì— ë”°ë¼ ìƒì„¸í•œ êµ¬í˜„ ê¸°ìˆ ì„ ë‹¤ë£¨ëŠ” `ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ì— ì¢…ì†`ëœë‹¤ëŠ” ì ì´ë‹¤.**              
     
## ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜ì— ì¢…ì†ëœ ì½”ë“œ  
ì˜ˆì‹œë¡œ `ë£° ì—”ì§„`ì„ ì ìš©ì‹œì¼œë³´ê² ë‹¤.         
ë•Œë¡œëŠ”, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì´ ë³µì¡í•´ì§€ë©´ ê°ì²´ ì§€í–¥ìœ¼ë¡œ ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” ê²ƒë³´ë‹¤         
[ë£° ì—”ì§„](https://javacan.tistory.com/entry/118)ì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ëŒ€ì•ˆì´ ë  ìˆ˜ ìˆë‹¤. (ì‹¤ì œë¡œë„ ì‚¬ìš©í•˜ëŠ”ì§€ëŠ” ì˜ ëª¨ë¥´ê² ë„¤ìš” ã…ã…;)        
         
> ë£° ì—”ì§„ì„ ê¹Šê²Œ ë‹¤ë£° í•„ìš”ëŠ” ì—†ë‹¤ ìƒê°í•©ë‹ˆë‹¤.       
> ë‹¤ë§Œ, ì¢…ì†ëœ ì½”ë“œë¥¼ ë³´ì—¬ì¤€ë‹¤ëŠ” ì£¼ì œì— ëŒ€í•´ì„œë§Œ íŒŒì•…í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.     

**CalculateDiscountService**
```java
public class CalculateDiscountService {
    private DroolsRuleEngine ruleEngine; // êµ¬í˜„ ê°ì²´ë¥¼ ì§ì ‘ ì‚¬ìš©  
    
    public CalculateDiscountService() {
        ruleEngine = new DroolsRuleEngine();
    }
    
    public Money calculateDiscount(List<OrderLine> orderLines, String customerId) {
        Customer customer = findCustomer(customerId);
        
        MutableMoney money = new MutableMoney(0);
        List<?> facts = Arrays.asList(customer, money);
        facts.addAll(orderLines);
        ruleEngine.evaluate("discountCalculation", facts);
        return money.toImmutableMoney();  
    }
    
}
``` 
**DroolsRuleEngine**    
```java
public class DroolsRuleEngine {
    private KieContainer KContainer;
    
    public DroolsRuleEngine() {
        KieService ks = KieServices.Factory.get();
        KContainer = ks.getKieClasspathContainer();
    }
    
    public void evalute(String sessionName, List<?> facts) {
        KieSession KSession = KContainer.newKieSession(sessionName);
        try {
            facts.forEach(x -> KSession.insert(x));
            KSession.fireAllRules();
        } finally {
            KSession.dispose();
        }
    }
    
}
```  
`DroolsRuleEngine`ëŠ” `DroolsRuleEngine`ë¼ëŠ” `ë£° ì—”ì§„`ì„ ì‚¬ìš©í•˜ëŠ” `ì¸í”„ë¼ìŠ¤íŠ¸ëŸ­ì²˜ ì˜ì—­`ì˜ ì½”ë“œë‹¤.             
`evalute()` ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ **ë³„ë„ì˜ íŒŒì¼ë¡œ ì‘ì„±í•œ ê·œì¹™ì„ ì´ìš©í•´ì„œ ì—°ì‚°ì„ ìˆ˜í–‰í•˜ëŠ” ì½”ë“œ**ë¼ê³ ë§Œ ìƒê°í•˜ì.       
      
**ìœ„ ì½”ë“œëŠ” 2ê°œì˜ í° ë¬¸ì œë¥¼ ê°€ì§€ê³  ìˆë‹¤.**        
1. **`CalculateDiscountService`ë§Œì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë µë‹¤. :**   
   `CalculateDiscountService`ë¥¼ í…ŒìŠ¤íŠ¸í•˜ë ¤ë©´ `RuleEngine`ì´ ì™„ë²½í•˜ê²Œ ë™ì‘í•´ì•¼í•œë‹¤.    
   ì¦‰, **`RuleEngine`ì„ ì„¤ì • íŒŒì¼ì„ ë§Œë“ í›„ì—ì•¼ ì •ìƒì ì¸ í…ŒìŠ¤íŠ¸ê°€ ê°€ëŠ¥í•˜ë‹¤**ëŠ” ì ì´ë‹¤.  
2. **ë³€ê²½ì´ ì–´ë µë‹¤.**    
   ```java
        MutableMoney money = new MutableMoney(0);
        List<?> facts = Arrays.asList(customer, money);
        facts.addAll(orderLines);
        ruleEngine.evaluate("discountCalculation", facts);
   ```
   ì´ ì½”ë“œë“¤ì€ `Drools`ì— íŠ¹í™”ëœ ì½”ë“œë¡œ, **ë³€ê²½ì´ ìˆì„ ê²½ìš° í˜„ì¬ í´ë˜ìŠ¤ì—ë„ ì˜í–¥ì´ ê°„ë‹¤.**     
   ì¦‰, `Drools`ì´ ì•„ë‹Œ ë‹¤ë¥¸ ì¼€ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê³ ì í•œë‹¤ë©´ `CalculateDiscountService`ì˜ ì½”ë“œë„ ë³€ê²½í•´ì•¼í•œë‹¤.      
            
ì´ì²˜ëŸ¼ `CalculateDiscountService`ê°€ êµ¬í˜„ ê°ì²´ë¥¼ ì§ì ‘ ì˜ì¡´í•˜ê³  ìˆìœ¼ë¯€ë¡œ           
ë‹¤ë¥¸ êµ¬í˜„ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ê³ ì í•  ë•Œ ì½”ë“œì˜ ë§ì€ ë¶€ë¶„ì„ ê³ ì³ì•¼í•œë‹¤.     
       
ì •ë¦¬í•˜ìë©´, **`ì¸í”„ë¼ ìŠ¤íŠ¸ëŸ­ì²˜`ì˜ì—­ì˜ ê¸°ìˆ ì„ ì§ì ‘ ì˜ì¡´**í•˜ê³  ìˆëŠ”ë‹¤ë©´     
**`í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€`ê³¼ `ê¸°ëŠ¥ í™•ì¥ì˜ ì–´ë ¤ì›€`ì´ë¼ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.**   
         
## DIP       
`CalculateDiscountService`ëŠ” **ì˜ë¯¸ìˆëŠ” ë‹¨ì¼ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” `ê³ ìˆ˜ì¤€ ëª¨ë“ˆ`ì´ë‹¤.**         
ê·¸ë¦¬ê³  `ê³ ìˆ˜ì¤€ ëª¨ë“ˆ`ì˜ ê¸°ëŠ¥ì„ êµ¬í˜„í•˜ë ¤ë©´ **ì—¬ëŸ¬ í•˜ìœ„ ê¸°ëŠ¥ì´ í•„ìš”í•˜ë‹¤.**       
ì˜ˆì‹œë¥¼ ë“¤ë©´, `ê³ ê° ì •ë³´ë¥¼ êµ¬í•˜ê¸°`, `ë£° ì‹¤í–‰`ë¼ëŠ” `2 ê°€ì§€ í•˜ìœ„ ê¸°ëŠ¥`ì´ í•„ìš”í•˜ë‹¤.       
       
**`ì €ìˆ˜ì¤€ ëª¨ë“ˆ`ì€ í•˜ìœ„ ê¸°ëŠ¥ì„ ì‹¤ì œë¡œ êµ¬í˜„í•œ ê²ƒì´ë‹¤.**        
`JPA`ë¥¼ ì´ìš©í•´ì„œ ê³ ê° ì •ë³´ë¥¼ì½ì–´ì˜¤ëŠ” ëª¨ë“ˆê³¼     
`Drools`ë¡œ ë£°ì„ ì‹¤í–‰í•˜ëŠ” ëª¨ë“ˆì´ ì €ìˆ˜ì¤€ ëª¨ë“ˆì´ ëœë‹¤.     

`ê³ ìˆ˜ì¤€ ëª¨ë“ˆ`ì´ ì œëŒ€ë¡œ ë™ì‘í•˜ë ¤ë©´ `ì €ìˆ˜ì¤€ ëª¨ë“ˆ`ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.   
ê·¸ëŸ°ë°, `ê³ ìˆ˜ì¤€ ëª¨ë“ˆ`ë“¤ì´ `ì €ìˆ˜ì¤€ ëª¨ë“ˆ`ì„ ì‚¬ìš©í•˜ë©´      
**`í…ŒìŠ¤íŠ¸ ì–´ë ¤ì›€`ê³¼ `ê¸°ëŠ¥ í™•ì¥ì˜ ì–´ë ¤ì›€`ì´ë¼ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.**     
ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ìš°ë¦¬ëŠ” **ì¶”ìƒí™”í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.**    
      
`CalculaterDiscountService` ì…ì¥ì— ë´¤ì„ ë•Œ `ì–´ë–»ê²Œ êµ¬í˜„`í–ˆëŠ”ì§€ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šë‹¤.     
ë‹¨ì§€, `ê³ ê° ì •ë³´ì™€ êµ¬ë§¤ ì •ë³´ì— ë£°ì„ ì ìš©í•´ì„œ í• ì¸ ê¸ˆì•¡ì„ êµ¬í•œë‹¤`ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.     
   
```java
public interface RuleDiscounter {
    public Money applyRules(Customer customer, List<OrderLine> orderLines);   
}
```
```java
public class CalculateDiscountService {
    private RuleDiscounter ruleDiscounter;
    
    public CalculateDiscountService(RuleDiscounter ruleDiscounter) {
        this.ruleDiscounter = ruleDiscounter;
    }
    
    public Money calculateDiscount(List<OrderLine> orderLines, String customerId) {
        Customer customer = findCustomer(customerId);
        return ruleDiscounter.applyRules(customer, orderLines);
    }
    
}
```  
```java
public class DroolsRuleEngine implements RuleDiscounter {
    private KieContainer KContainer;
    
    public DroolsRuleEngine() {
        KieService ks = KieServices.Factory.get();
        KContainer = ks.getKieClasspathContainer();
    }
    
    public void evalute(String sessionName, List<?> facts) {
        KieSession KSession = KContainer.newKieSession(sessionName);
        try {
            facts.forEach(x -> KSession.insert(x));
            KSession.fireAllRules();
        } finally {
            KSession.dispose();
        }
    }
    
}
```
ì´ ê°™ì´ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì°¸ì¡°ë³€ìˆ˜ë¡œ ë‘ê³  êµ¬í˜„ì²´ë¥¼ ìƒì„±ìë¡œ ë°›ëŠ”ë‹¤ë©´          
`CalculaterDiscountService`ëŠ” ë” ì´ìƒ `íŠ¹ì • êµ¬í˜„ì²´`ì— ì˜ì¡´í•˜ì§€ ì•Šê²Œ ëœë‹¤.   
ì •í™•íˆ ë§í•˜ë©´ `íŠ¹ì • ì¸í„°í˜ì´ìŠ¤`ë¥¼ ì˜ì¡´í•˜ëŠ” í˜•íƒœê°€ ë˜ì—ˆë‹¤.       
  
`ì¸í„°í˜ì´ìŠ¤`ìì²´ëŠ” ê³ ìˆ˜ì¤€ ëª¨ë“ˆì— ì†í•œë‹¤.     
ê·¸ë ‡ê¸°ì— `ê³ ìˆ˜ì¤€ ëª¨ë“ˆ`ì—ì„œ `ì €ì†Œì¤€ ëª¨ë“ˆ`ì„ ì§ì ‘ì ìœ¼ë¡œ ì˜ì¡´í•˜ê³  ìˆì§€ëŠ” ì•Šë‹¤.   











